/**
 * 제11장: 건강운 분석
 * 연령대별 분기 (20대/30대/40대/50대 이상)
 */

import type { SajuApiResult, FiveElement, Gender, AgeGroup } from "@/types/saju";
import type { Chapter11Result } from "@/types/expert";

// ============================================
// 타입 정의
// ============================================

type HeavenlyStemKr = "갑" | "을" | "병" | "정" | "무" | "기" | "경" | "신" | "임" | "계";
type StrengthType = "신강" | "신약" | "중화";

// ============================================
// 신강신약별 건강운 상세 서술 상수 (5오행 × 3신강신약 × 4연령대 = 60조합)
// ============================================

const HEALTH_STRENGTH_NARRATIVES: Record<FiveElement, Record<StrengthType, Record<AgeGroup, {
  constitution: string;
  vulnerabilities: string;
  strengthening: string;
  lifestyle: string;
  prevention: string;
}>>> = {
  wood: {
    신강: {
      "20s": {
        constitution: "목 기운이 강한 20대는 에너지가 넘치고 활동적입니다. 간과 담의 기능이 활발하여 해독 능력이 뛰어나고 근육 발달이 좋습니다.",
        vulnerabilities: "그러나 과도한 활동과 무리로 인해 건강을 해칠 수 있습니다. 음주와 야식이 잦으면 간에 무리가 가기 시작합니다. 눈의 피로와 두통이 나타날 수 있습니다.",
        strengthening: "목 기운을 적절히 발산하되 과용하지 않도록 하세요. 신맛 음식(식초, 레몬, 매실)은 적당히, 녹색 채소(시금치, 브로콜리)를 충분히 섭취하세요.",
        lifestyle: "규칙적인 수면 패턴을 형성하고 음주를 절제하세요. 스트레칭과 유연성 운동이 좋습니다. 분노 조절에 신경 쓰세요.",
        prevention: "20대에 형성되는 음주 습관이 30대 이후 간 건강에 직접적인 영향을 미칩니다. 지금부터 절제하세요."
      },
      "30s": {
        constitution: "목 기운이 강한 30대는 직장에서 추진력 있게 일하며 성과를 내는 시기입니다. 그러나 과로와 스트레스가 간 건강을 위협합니다.",
        vulnerabilities: "잦은 회식과 음주, 업무 스트레스가 간 기능을 저하시킵니다. 눈 건조와 시력 저하, 만성 두통이 나타날 수 있습니다. 급한 성격으로 인한 혈압 상승에 주의하세요.",
        strengthening: "간 해독을 돕는 음식(부추, 미나리, 깻잎)을 섭취하세요. 등푸른 생선의 오메가3가 도움이 됩니다. 비타민 B군 보충을 고려하세요.",
        lifestyle: "주 2회 이상 음주를 피하고, 회식 다음 날은 가벼운 식사를 하세요. 명상이나 호흡 운동으로 스트레스를 관리하세요. 저녁 시간에는 눈을 쉬게 하세요.",
        prevention: "지금 시기의 간 건강 관리가 40대 이후의 만성 질환 예방에 핵심입니다. 정기적인 간 기능 검사를 받으세요."
      },
      "40s": {
        constitution: "목 기운이 강한 40대는 축적된 스트레스와 과로의 영향이 본격적으로 나타나는 시기입니다. 간 기능 저하와 눈 건강 악화에 주의해야 합니다.",
        vulnerabilities: "지방간, 간 수치 이상이 나타나기 쉽습니다. 노안이 시작되고 눈 피로가 만성화됩니다. 고혈압 위험이 높아집니다. 근육 경직과 관절 문제가 생깁니다.",
        strengthening: "간에 좋은 음식(우엉, 배, 솔잎차)을 규칙적으로 섭취하세요. 블루베리 등 눈 건강에 좋은 음식을 챙기세요. 기름진 음식을 줄이세요.",
        lifestyle: "음주를 대폭 줄이고 간 휴식일을 정하세요. 요가나 태극권 등 부드러운 운동을 하세요. 장시간 모니터 사용을 피하고 눈 휴식을 취하세요.",
        prevention: "매년 간 초음파와 간 기능 검사를 받으세요. 안과 정기 검진도 필수입니다. 혈압 관리를 시작하세요."
      },
      "50plus": {
        constitution: "목 기운이 강한 50대 이후는 그간의 생활습관이 건강으로 나타나는 시기입니다. 간 건강과 눈 건강 관리가 삶의 질을 결정합니다.",
        vulnerabilities: "간경화, 담석 등 간담 질환 위험이 높습니다. 백내장, 녹내장 등 눈 질환에 주의하세요. 고혈압과 뇌혈관 질환 위험이 있습니다. 근육량 감소와 관절 퇴행이 진행됩니다.",
        strengthening: "단백질을 충분히 섭취하여 근육을 유지하세요. 항산화 식품(베리류, 녹차)으로 노화를 늦추세요. 간에 부담을 주는 음식과 약물을 피하세요.",
        lifestyle: "규칙적이고 적당한 운동으로 기혈 순환을 도우세요. 사회 활동으로 정신 건강도 챙기세요. 충분한 수면과 낮잠으로 간 회복 시간을 확보하세요.",
        prevention: "6개월마다 종합 검진을 받으세요. 간암 검진, 안과 정밀 검사를 놓치지 마세요. 혈압약 복용 시 간 영향을 확인하세요."
      }
    },
    신약: {
      "20s": {
        constitution: "목 기운이 약한 20대는 에너지가 부족하고 쉽게 피로해질 수 있습니다. 간 해독 기능이 약하여 술이나 자극적인 음식에 민감합니다.",
        vulnerabilities: "소량의 음주에도 숙취가 심하고 회복이 느립니다. 눈이 쉽게 피로하고 충혈됩니다. 우울감이나 의욕 저하가 나타날 수 있습니다. 손톱이 약하고 잘 갈라집니다.",
        strengthening: "간 기능을 보강하는 음식(대추, 구기자, 쑥)을 꾸준히 섭취하세요. 신맛 음식으로 간을 자극하되 너무 많이는 안 됩니다. 철분이 풍부한 음식을 먹으세요.",
        lifestyle: "충분한 수면(8시간 이상)을 확보하세요. 음주는 극히 절제하세요. 가벼운 스트레칭과 산책으로 기혈 순환을 도우세요. 긍정적인 마음가짐을 유지하세요.",
        prevention: "지금부터 간 건강을 챙기지 않으면 30대에 만성 피로가 고착됩니다. 정기 검진을 시작하세요."
      },
      "30s": {
        constitution: "목 기운이 약한 30대는 직장 생활의 스트레스를 감당하기 어려울 수 있습니다. 피로 회복력이 떨어지고 만성 피로에 시달립니다.",
        vulnerabilities: "지속적인 피로감과 무기력함이 나타납니다. 눈 건조증, 안구 피로가 심합니다. 소화불량과 식욕부진이 올 수 있습니다. 우울증이나 불안장애 위험이 있습니다.",
        strengthening: "한약재(인삼, 황기, 당귀)로 기력을 보충하세요. 녹색 채소와 단백질을 균형 있게 섭취하세요. 비타민 B, 철분 보충제를 고려하세요.",
        lifestyle: "무리한 야근을 피하고 휴식 시간을 확보하세요. 명상과 심호흡으로 스트레스를 관리하세요. 취미 활동으로 정서적 안정을 찾으세요. 규칙적인 수면 리듬을 유지하세요.",
        prevention: "만성 피로를 방치하면 면역력 저하로 이어집니다. 정기적인 간 기능 검사와 함께 정신 건강 상담도 고려하세요."
      },
      "40s": {
        constitution: "목 기운이 약한 40대는 체력 저하가 두드러지는 시기입니다. 간 기능 약화로 해독 능력이 떨어지고 만성 질환 위험이 높아집니다.",
        vulnerabilities: "간 기능 저하로 인한 피로, 황달, 소화장애가 나타날 수 있습니다. 근육량 감소가 빠르게 진행됩니다. 눈 건강이 급격히 나빠집니다. 우울증 경향이 심화될 수 있습니다.",
        strengthening: "보양 음식(삼계탕, 추어탕, 장어)으로 기력을 보충하세요. 한방 치료를 통한 간 기능 강화를 고려하세요. 단백질 섭취를 늘려 근육을 유지하세요.",
        lifestyle: "충분한 휴식과 수면이 가장 중요합니다. 가벼운 운동(걷기, 수영)을 꾸준히 하세요. 정서적 지지 체계(가족, 친구)를 유지하세요. 무리한 일정을 피하세요.",
        prevention: "6개월마다 간 기능 검사와 종합 검진을 받으세요. 정신 건강 상담도 주기적으로 받는 것이 좋습니다."
      },
      "50plus": {
        constitution: "목 기운이 약한 50대 이후는 전반적인 기력 저하와 함께 각종 질환 위험이 높아집니다. 적극적인 건강 관리가 필수입니다.",
        vulnerabilities: "간 질환(지방간, 간경화)이 발병할 수 있습니다. 근감소증으로 낙상 위험이 높아집니다. 눈 질환(백내장, 황반변성)이 진행됩니다. 우울증과 무기력감이 심화됩니다.",
        strengthening: "소화가 잘 되는 보양 음식을 규칙적으로 섭취하세요. 전문 한의사의 처방을 받아 체질에 맞는 보약을 복용하세요. 고단백 식단으로 근육량을 유지하세요.",
        lifestyle: "규칙적인 생활 리듬을 유지하세요. 가벼운 근력 운동으로 근육을 키우세요. 사회 활동과 취미로 정서적 건강을 챙기세요. 낮잠은 30분 이내로 하세요.",
        prevention: "3개월마다 정기 검진을 받으세요. 간 초음파, 안과 검진, 골밀도 검사를 빠짐없이 받으세요. 우울 증상이 있으면 전문 상담을 받으세요."
      }
    },
    중화: {
      "20s": {
        constitution: "목 기운이 균형 잡힌 20대는 간담 기능이 안정적이고 회복력이 좋습니다. 이 시기에 좋은 습관을 들이면 평생 건강의 기초가 됩니다.",
        vulnerabilities: "균형 잡혀 있으나 나쁜 습관이 쌓이면 균형이 깨질 수 있습니다. 과도한 음주, 불규칙한 생활이 간 건강을 서서히 해칩니다. 스트레스 관리를 소홀히 하면 문제가 생깁니다.",
        strengthening: "현재의 균형을 유지하는 것이 중요합니다. 녹색 채소와 단백질을 균형 있게 섭취하세요. 신맛 음식은 적당히 섭취하세요.",
        lifestyle: "규칙적인 생활 습관을 유지하세요. 주 3회 이상 운동하세요. 음주는 주 1회 적당량으로 제한하세요. 수면 시간을 일정하게 유지하세요.",
        prevention: "매년 기본 건강검진을 받으세요. 좋은 상태를 유지하는 것이 가장 중요합니다."
      },
      "30s": {
        constitution: "목 기운이 균형 잡힌 30대는 체력과 정신력이 안정된 상태입니다. 직장 스트레스를 적절히 관리하면 건강을 유지할 수 있습니다.",
        vulnerabilities: "직장 스트레스와 불규칙한 생활이 균형을 깨뜨릴 수 있습니다. 과로와 회식이 잦으면 간 건강이 약해지기 시작합니다. 눈 피로와 두통이 나타날 수 있습니다.",
        strengthening: "균형을 유지하기 위해 규칙적인 식사와 충분한 휴식이 중요합니다. 간에 좋은 음식(부추, 미나리)을 주기적으로 섭취하세요. 눈 건강을 위해 블루베리, 당근을 챙기세요.",
        lifestyle: "업무와 휴식의 균형을 맞추세요. 회식은 절제하고 음주량을 조절하세요. 주말에는 충분히 휴식하세요. 스트레스 해소를 위한 취미를 가지세요.",
        prevention: "매년 종합 건강검진을 받으세요. 간 기능 검사를 포함하세요. 균형이 깨지기 전에 예방하는 것이 중요합니다."
      },
      "40s": {
        constitution: "목 기운이 균형 잡힌 40대는 안정된 건강 상태를 유지하기 좋은 조건입니다. 하지만 노화가 시작되므로 관리가 필요합니다.",
        vulnerabilities: "노화로 인해 간 기능이 서서히 저하됩니다. 노안이 시작되고 눈 피로가 증가합니다. 혈압 변화에 주의해야 합니다. 근육량이 감소하기 시작합니다.",
        strengthening: "항산화 식품(베리류, 녹차, 토마토)을 충분히 섭취하세요. 단백질로 근육을 유지하세요. 간에 부담을 주는 기름진 음식을 줄이세요.",
        lifestyle: "규칙적인 운동을 지속하세요. 음주량을 더 줄이세요. 충분한 수면을 취하세요. 정기적인 안과 검진을 받으세요.",
        prevention: "매년 종합 검진과 간 초음파를 받으세요. 안과 검진을 시작하세요. 혈압을 정기적으로 체크하세요."
      },
      "50plus": {
        constitution: "목 기운이 균형 잡힌 50대 이후는 그간의 건강한 습관이 빛을 발하는 시기입니다. 꾸준한 관리로 건강한 노년을 맞이할 수 있습니다.",
        vulnerabilities: "노화에 따른 전반적인 기능 저하가 진행됩니다. 눈 건강(백내장, 녹내장)에 주의가 필요합니다. 혈압과 혈당 관리가 중요해집니다. 근감소증을 예방해야 합니다.",
        strengthening: "소화가 잘 되는 영양가 있는 음식을 규칙적으로 섭취하세요. 단백질과 칼슘을 충분히 섭취하세요. 항산화 식품으로 노화를 늦추세요.",
        lifestyle: "규칙적인 생활 리듬을 유지하세요. 적당한 운동으로 근력과 유연성을 유지하세요. 사회 활동으로 정신 건강을 챙기세요. 충분한 휴식을 취하세요.",
        prevention: "6개월마다 종합 검진을 받으세요. 간, 눈, 심혈관 검사를 빠짐없이 받으세요. 필요시 약물 복용도 적극적으로 고려하세요."
      }
    }
  },
  fire: {
    신강: {
      "20s": {
        constitution: "화 기운이 강한 20대는 열정적이고 활력이 넘칩니다. 심장과 혈관 기능이 활발하여 체력이 좋고 활동적입니다.",
        vulnerabilities: "그러나 흥분하기 쉽고 과도한 활동으로 심장에 부담이 갈 수 있습니다. 불면증과 불안감이 나타날 수 있습니다. 피부 트러블과 과도한 발한이 있을 수 있습니다.",
        strengthening: "쓴맛 음식(쓴 채소, 녹차)으로 심장을 안정시키세요. 붉은 음식(토마토, 수박)은 적당히 섭취하세요. 뜨겁고 매운 음식을 피하세요.",
        lifestyle: "흥분을 자제하고 명상으로 마음을 안정시키세요. 수영이나 물과 관련된 운동이 열을 식혀줍니다. 규칙적인 수면 습관을 들이세요. 카페인을 줄이세요.",
        prevention: "젊어서 심장 건강을 챙기지 않으면 30대 이후 고혈압이 시작됩니다. 지금부터 관리하세요."
      },
      "30s": {
        constitution: "화 기운이 강한 30대는 직장에서 열정적으로 일하지만 번아웃 위험이 있습니다. 심장과 혈관에 스트레스가 누적됩니다.",
        vulnerabilities: "만성 스트레스로 인한 고혈압 경향이 나타납니다. 불면증과 불안장애가 심화될 수 있습니다. 두근거림과 가슴 답답함이 있을 수 있습니다. 피부 트러블이 지속됩니다.",
        strengthening: "심장 건강에 좋은 음식(견과류, 등푸른생선, 올리브오일)을 섭취하세요. 녹차와 국화차가 열을 식혀줍니다. 짜고 자극적인 음식을 피하세요.",
        lifestyle: "스트레스 관리가 최우선입니다. 요가나 명상을 시작하세요. 수면 환경을 개선하세요. 저녁에는 자극적인 활동을 피하세요. 심호흡을 자주 하세요.",
        prevention: "정기적으로 혈압을 체크하세요. 심전도 검사를 받으세요. 번아웃 증상이 있으면 휴식을 취하세요."
      },
      "40s": {
        constitution: "화 기운이 강한 40대는 고혈압과 심혈관 질환 위험이 본격적으로 높아집니다. 적극적인 관리가 필요합니다.",
        vulnerabilities: "고혈압, 부정맥, 협심증 증상에 주의하세요. 불면증이 만성화될 수 있습니다. 갱년기 증상(홍조, 발한)이 심할 수 있습니다. 정신적 불안정이 나타날 수 있습니다.",
        strengthening: "저염식, 저지방 식단을 유지하세요. 오메가3가 풍부한 음식을 섭취하세요. 카페인과 알코올을 줄이세요. 심장에 좋은 베리류를 섭취하세요.",
        lifestyle: "혈압 관리를 철저히 하세요. 무리한 운동은 피하고 걷기, 수영을 하세요. 충분한 수면과 휴식이 중요합니다. 명상으로 마음의 평화를 찾으세요.",
        prevention: "매년 심혈관 정밀 검사를 받으세요. 혈압약 복용이 필요하면 미루지 마세요. 스트레스 관리 상담도 받으세요."
      },
      "50plus": {
        constitution: "화 기운이 강한 50대 이후는 심혈관 건강이 삶의 질을 결정합니다. 철저한 관리로 건강한 노년을 보낼 수 있습니다.",
        vulnerabilities: "심장병, 뇌졸중 위험이 높아집니다. 만성 불면과 불안이 지속됩니다. 혈압 변동이 심할 수 있습니다. 말초혈관 순환 장애가 나타날 수 있습니다.",
        strengthening: "심장 건강 식단을 철저히 지키세요. 저염, 저지방, 고섬유질 식사를 하세요. 항산화 음식으로 혈관을 보호하세요. 수분을 충분히 섭취하세요.",
        lifestyle: "규칙적인 생활과 적당한 운동을 유지하세요. 흥분과 격한 감정을 피하세요. 사회 활동으로 정서적 안정을 찾으세요. 충분한 휴식을 취하세요.",
        prevention: "3개월마다 심혈관 검사를 받으세요. 혈압약을 꾸준히 복용하세요. 응급 상황에 대비하세요."
      }
    },
    신약: {
      "20s": {
        constitution: "화 기운이 약한 20대는 열정이 부족하고 우울한 경향이 있습니다. 심장 기능이 약하여 체력이 떨어지고 쉽게 지칩니다.",
        vulnerabilities: "혈압이 낮고 빈혈 기미가 있습니다. 손발이 차고 혈액순환이 원활하지 않습니다. 의욕 저하와 우울감이 나타납니다. 소화력이 약할 수 있습니다.",
        strengthening: "심장을 보강하는 음식(대추, 계피, 생강)을 섭취하세요. 따뜻한 성질의 음식을 먹으세요. 철분과 비타민 B군을 보충하세요. 쓴맛보다 단맛을 적당히 섭취하세요.",
        lifestyle: "따뜻하게 몸을 보호하세요. 규칙적인 유산소 운동으로 심폐 기능을 강화하세요. 긍정적인 활동과 사회적 교류를 늘리세요. 아침 햇살을 쬐세요.",
        prevention: "빈혈 검사와 심전도 검사를 받으세요. 우울 증상이 있으면 상담을 받으세요. 지금부터 심폐 기능을 키우세요."
      },
      "30s": {
        constitution: "화 기운이 약한 30대는 직장에서 에너지가 부족하고 번아웃되기 쉽습니다. 심장과 순환기가 약해 쉽게 지칩니다.",
        vulnerabilities: "만성 피로와 무기력함이 지속됩니다. 저혈압과 빈혈이 나타날 수 있습니다. 우울증 경향이 심화됩니다. 손발 저림과 냉증이 있습니다.",
        strengthening: "보양 음식(삼계탕, 우황청심환)으로 기력을 보충하세요. 따뜻한 음식과 차를 마시세요. 철분제와 비타민을 복용하세요. 양고기, 닭고기 등 온성 식품을 섭취하세요.",
        lifestyle: "무리한 업무를 피하고 충분히 휴식하세요. 따뜻한 목욕으로 혈액순환을 도우세요. 적당한 운동으로 심폐 기능을 키우세요. 긍정적인 마음을 유지하세요.",
        prevention: "정기적으로 심장 검사를 받으세요. 빈혈 관리를 철저히 하세요. 우울증 상담도 고려하세요."
      },
      "40s": {
        constitution: "화 기운이 약한 40대는 심장 기능 저하와 순환기 문제가 본격화됩니다. 적극적인 보양과 관리가 필요합니다.",
        vulnerabilities: "심장 기능 약화로 숨이 쉽게 찹니다. 저혈압과 빈혈이 심화됩니다. 손발 냉증과 저림이 악화됩니다. 우울증과 무기력감이 깊어집니다.",
        strengthening: "보양식(인삼, 홍삼, 녹용)을 정기적으로 섭취하세요. 심장에 좋은 한약 처방을 받으세요. 따뜻한 성질의 음식을 위주로 먹으세요. 철분과 비타민을 보충하세요.",
        lifestyle: "무리하지 말고 규칙적으로 생활하세요. 따뜻하게 몸을 보호하세요. 가벼운 운동을 꾸준히 하세요. 정서적 지지 체계를 유지하세요.",
        prevention: "3개월마다 심장 검사를 받으세요. 한의원 진료도 병행하세요. 우울증 치료가 필요하면 받으세요."
      },
      "50plus": {
        constitution: "화 기운이 약한 50대 이후는 심장 기능이 더욱 약해지므로 철저한 관리가 필요합니다. 따뜻하게 보호하고 충분히 보양하세요.",
        vulnerabilities: "심부전, 부정맥 위험이 있습니다. 만성 피로와 무기력이 심합니다. 혈액순환 장애로 사지 냉증이 심합니다. 우울증과 인지 기능 저하가 올 수 있습니다.",
        strengthening: "소화가 잘 되는 보양식을 규칙적으로 섭취하세요. 홍삼, 녹용 등 보약을 복용하세요. 따뜻한 음식과 차를 자주 마시세요. 영양제로 부족분을 보충하세요.",
        lifestyle: "따뜻하게 지내고 추위를 피하세요. 규칙적인 생활 리듬을 유지하세요. 가벼운 운동을 꾸준히 하세요. 사회 활동과 취미로 정서 건강을 챙기세요.",
        prevention: "매달 심장 상태를 체크하세요. 필요시 심장 보조 약물을 복용하세요. 정신 건강 관리도 병행하세요."
      }
    },
    중화: {
      "20s": {
        constitution: "화 기운이 균형 잡힌 20대는 심장과 순환기 기능이 안정적입니다. 열정과 안정이 조화를 이루어 건강한 상태입니다.",
        vulnerabilities: "균형 잡혀 있지만 스트레스나 불규칙한 생활로 균형이 깨질 수 있습니다. 과도한 카페인이나 자극이 심장에 부담을 줄 수 있습니다.",
        strengthening: "현재의 균형을 유지하는 것이 중요합니다. 쓴맛과 단맛을 균형 있게 섭취하세요. 심장 건강에 좋은 음식을 꾸준히 먹으세요.",
        lifestyle: "규칙적인 생활 습관을 유지하세요. 적당한 운동과 충분한 수면을 취하세요. 스트레스를 잘 관리하세요. 카페인을 과도하게 섭취하지 마세요.",
        prevention: "매년 기본 건강검진과 심전도 검사를 받으세요. 균형 유지가 가장 중요합니다."
      },
      "30s": {
        constitution: "화 기운이 균형 잡힌 30대는 심혈관 건강이 양호한 상태입니다. 적절한 관리로 이 상태를 유지하는 것이 중요합니다.",
        vulnerabilities: "직장 스트레스로 인해 혈압이 오르거나 불면이 생길 수 있습니다. 과로하면 심장에 부담이 갈 수 있습니다.",
        strengthening: "균형 잡힌 식단을 유지하세요. 오메가3와 항산화 음식을 섭취하세요. 자극적인 음식과 카페인을 절제하세요.",
        lifestyle: "일과 휴식의 균형을 맞추세요. 스트레스 관리에 신경 쓰세요. 규칙적인 운동을 하세요. 충분한 수면을 취하세요.",
        prevention: "매년 종합 검진과 심혈관 검사를 받으세요. 혈압을 정기적으로 체크하세요."
      },
      "40s": {
        constitution: "화 기운이 균형 잡힌 40대는 심혈관 건강 관리의 중요한 시기입니다. 균형을 유지하면서 노화에 대비하세요.",
        vulnerabilities: "노화로 인해 혈관 탄력이 떨어지기 시작합니다. 혈압 변화에 주의가 필요합니다. 스트레스가 심장에 미치는 영향이 커집니다.",
        strengthening: "저염식, 저지방 식단으로 전환하세요. 심장 건강에 좋은 음식을 꾸준히 섭취하세요. 항산화 음식으로 혈관을 보호하세요.",
        lifestyle: "규칙적인 유산소 운동을 하세요. 스트레스 관리에 더욱 신경 쓰세요. 충분한 휴식과 수면을 취하세요. 명상이나 이완 운동을 하세요.",
        prevention: "매년 심혈관 정밀 검사를 받으세요. 혈압과 콜레스테롤을 정기적으로 체크하세요."
      },
      "50plus": {
        constitution: "화 기운이 균형 잡힌 50대 이후는 그간의 건강 관리가 빛을 발하는 시기입니다. 꾸준한 관리로 건강한 노년을 맞이하세요.",
        vulnerabilities: "노화에 따른 심혈관 기능 저하가 진행됩니다. 혈압과 혈당 관리가 더욱 중요해집니다. 불규칙한 맥박에 주의하세요.",
        strengthening: "심장 건강 식단을 철저히 지키세요. 소화가 잘 되는 영양 식품을 섭취하세요. 수분을 충분히 섭취하세요.",
        lifestyle: "규칙적인 생활과 적당한 운동을 유지하세요. 감정 기복을 줄이세요. 사회 활동으로 정서 건강을 챙기세요. 정기적인 휴식을 취하세요.",
        prevention: "6개월마다 심혈관 검사를 받으세요. 필요시 약물 치료를 받으세요. 응급 상황에 대비하세요."
      }
    }
  },
  earth: {
    신강: {
      "20s": {
        constitution: "토 기운이 강한 20대는 소화력이 좋고 체력이 튼튼합니다. 비위 기능이 활발하여 먹는 것을 좋아하고 체중이 늘기 쉽습니다.",
        vulnerabilities: "과식과 폭식 경향이 있습니다. 비만과 당뇨 위험이 있습니다. 위장에 열이 많아 위염이 올 수 있습니다. 피부 트러블이 생기기 쉽습니다.",
        strengthening: "과식을 피하고 절제하세요. 단맛을 줄이고 쓴맛 채소를 섭취하세요. 식이섬유가 풍부한 음식을 먹으세요. 규칙적인 식사 시간을 지키세요.",
        lifestyle: "식사량을 조절하고 야식을 피하세요. 규칙적인 운동으로 체중을 관리하세요. 유산소 운동과 근력 운동을 병행하세요. 식후 가벼운 산책을 하세요.",
        prevention: "매년 혈당과 콜레스테롤을 체크하세요. 체중 관리를 시작하세요. 젊어서 만든 습관이 평생 갑니다."
      },
      "30s": {
        constitution: "토 기운이 강한 30대는 회식과 외식이 잦아지면서 비만과 대사 질환 위험이 높아집니다. 식습관 관리가 핵심입니다.",
        vulnerabilities: "비만과 고지혈증이 나타나기 시작합니다. 당뇨 전단계에 진입할 수 있습니다. 소화불량과 위장 질환이 생깁니다. 복부비만이 심해집니다.",
        strengthening: "저당, 저지방 식단을 유지하세요. 현미, 잡곡 등 복합탄수화물을 섭취하세요. 야채와 단백질 위주로 식사하세요. 단 음식과 탄산음료를 피하세요.",
        lifestyle: "회식에서 과음과 과식을 피하세요. 주 3회 이상 운동하세요. 엘리베이터 대신 계단을 이용하세요. 점심 후 산책을 습관화하세요.",
        prevention: "매년 종합검진에서 당뇨, 고지혈증을 확인하세요. 체중 변화를 기록하세요. 위내시경을 시작하세요."
      },
      "40s": {
        constitution: "토 기운이 강한 40대는 대사 기능이 떨어지면서 비만과 성인병이 본격화됩니다. 철저한 관리가 필요합니다.",
        vulnerabilities: "당뇨병과 고혈압이 발병할 수 있습니다. 비만과 고지혈증이 심화됩니다. 위궤양, 역류성 식도염이 생깁니다. 지방간과 통풍 위험이 있습니다.",
        strengthening: "저칼로리, 고단백, 고섬유질 식단을 유지하세요. 설탕과 정제 탄수화물을 피하세요. 비위에 좋은 음식(쌀, 감자, 대추)을 적당히 섭취하세요. 술과 자극적인 음식을 피하세요.",
        lifestyle: "체중 관리를 최우선 과제로 삼으세요. 규칙적인 운동을 하세요. 식사량을 줄이고 천천히 먹으세요. 스트레스를 줄이세요.",
        prevention: "3개월마다 혈당과 혈압을 체크하세요. 필요시 약물 치료를 시작하세요. 위내시경을 정기적으로 받으세요."
      },
      "50plus": {
        constitution: "토 기운이 강한 50대 이후는 당뇨, 비만, 고혈압 등 대사 질환 관리가 건강의 핵심입니다. 철저한 생활 관리가 필요합니다.",
        vulnerabilities: "당뇨 합병증(신경병증, 망막병증, 신장병증)이 올 수 있습니다. 심혈관 질환 위험이 높습니다. 위암, 대장암 위험에 주의하세요. 관절에 부담이 갑니다.",
        strengthening: "당뇨식, 고혈압식을 철저히 지키세요. 저염, 저당, 저지방 식단을 유지하세요. 소화가 잘 되는 음식을 먹으세요. 수분을 충분히 섭취하세요.",
        lifestyle: "규칙적인 생활과 식사를 하세요. 매일 가벼운 운동을 하세요. 체중을 적정 수준으로 유지하세요. 약물 복용을 철저히 관리하세요.",
        prevention: "매달 혈당과 혈압을 체크하세요. 6개월마다 당뇨 합병증 검사를 받으세요. 암 검진을 빠짐없이 받으세요."
      }
    },
    신약: {
      "20s": {
        constitution: "토 기운이 약한 20대는 소화력이 약하고 영양 흡수가 잘 안 됩니다. 마른 체형이 많고 쉽게 피로합니다.",
        vulnerabilities: "식욕부진과 소화불량이 잦습니다. 빈혈과 영양 결핍이 올 수 있습니다. 무기력하고 집중력이 떨어집니다. 면역력이 약해 잦은 감기에 걸립니다.",
        strengthening: "소화가 잘 되는 따뜻한 음식을 먹으세요. 비위를 보하는 음식(쌀죽, 찹쌀, 대추)을 섭취하세요. 규칙적인 식사를 하세요. 영양제로 부족분을 보충하세요.",
        lifestyle: "식사를 거르지 마세요. 차가운 음식과 날것을 피하세요. 스트레스를 줄이고 충분히 휴식하세요. 가벼운 운동으로 기혈 순환을 도우세요.",
        prevention: "빈혈 검사와 영양 상태를 확인하세요. 소화기 검진을 받으세요. 체력을 키우기 시작하세요."
      },
      "30s": {
        constitution: "토 기운이 약한 30대는 직장 스트레스로 소화기 문제가 악화됩니다. 불규칙한 식사가 비위를 더욱 약하게 합니다.",
        vulnerabilities: "만성 소화불량과 위장 장애가 있습니다. 영양 부족으로 피로가 심합니다. 면역력 저하로 잦은 질병에 걸립니다. 체중이 줄고 기력이 없습니다.",
        strengthening: "규칙적으로 따뜻한 음식을 먹으세요. 사상체질에 맞는 음식을 섭취하세요. 한약으로 비위 기능을 보강하세요. 영양제와 프로바이오틱스를 섭취하세요.",
        lifestyle: "식사 시간을 지키세요. 급하게 먹지 말고 천천히 씹으세요. 스트레스를 관리하세요. 충분한 수면을 취하세요.",
        prevention: "위내시경을 받으세요. 영양 상담을 받으세요. 한의원에서 체질 진단을 받으세요."
      },
      "40s": {
        constitution: "토 기운이 약한 40대는 소화기 기능이 더욱 약해지고 만성 질환이 생기기 쉽습니다. 적극적인 보양이 필요합니다.",
        vulnerabilities: "만성 위장병, 위궤양이 생길 수 있습니다. 영양실조와 빈혈이 심화됩니다. 면역력 저하로 각종 질환에 취약합니다. 기력 저하가 심합니다.",
        strengthening: "보양 음식(삼계탕, 전복죽, 호박죽)을 규칙적으로 섭취하세요. 한약 처방으로 비위를 보강하세요. 소화가 잘 되는 음식을 먹으세요. 영양제로 부족분을 보충하세요.",
        lifestyle: "무리하지 말고 충분히 휴식하세요. 따뜻하게 배를 보호하세요. 규칙적인 생활 습관을 유지하세요. 스트레스를 줄이세요.",
        prevention: "6개월마다 위내시경을 받으세요. 영양 상태를 정기적으로 확인하세요. 한의원 진료를 병행하세요."
      },
      "50plus": {
        constitution: "토 기운이 약한 50대 이후는 소화 흡수 능력이 더욱 떨어집니다. 영양 관리와 소화기 보양이 건강의 핵심입니다.",
        vulnerabilities: "만성 영양 부족과 쇠약이 심합니다. 위암, 대장암 위험에 주의하세요. 면역력 저하로 감염에 취약합니다. 근감소증과 골다공증이 진행됩니다.",
        strengthening: "소화가 쉬운 고영양 음식을 규칙적으로 섭취하세요. 단백질 보충에 신경 쓰세요. 보약과 영양제를 복용하세요. 프로바이오틱스로 장 건강을 관리하세요.",
        lifestyle: "규칙적인 식사와 생활을 하세요. 적당한 운동으로 근력을 유지하세요. 따뜻하게 지내세요. 사회 활동으로 정서 건강을 챙기세요.",
        prevention: "3개월마다 영양 상태와 체중을 확인하세요. 위암, 대장암 검진을 빠짐없이 받으세요. 필요시 영양 수액을 고려하세요."
      }
    },
    중화: {
      "20s": {
        constitution: "토 기운이 균형 잡힌 20대는 소화기 기능이 안정적입니다. 적당한 식욕과 좋은 영양 상태를 유지합니다.",
        vulnerabilities: "균형 잡혀 있지만 과식이나 불규칙한 식사로 균형이 깨질 수 있습니다. 스트레스가 소화기에 영향을 줄 수 있습니다.",
        strengthening: "현재의 균형을 유지하세요. 규칙적인 식사 습관을 들이세요. 과식을 피하고 균형 잡힌 식단을 유지하세요.",
        lifestyle: "규칙적인 생활 습관을 유지하세요. 식사 시간을 지키세요. 적당한 운동을 하세요. 스트레스를 관리하세요.",
        prevention: "매년 기본 건강검진을 받으세요. 좋은 식습관을 유지하는 것이 가장 중요합니다."
      },
      "30s": {
        constitution: "토 기운이 균형 잡힌 30대는 소화기 건강이 양호합니다. 직장 생활에서 식습관을 잘 관리하면 건강을 유지할 수 있습니다.",
        vulnerabilities: "불규칙한 식사와 회식으로 균형이 깨질 수 있습니다. 스트레스성 위장 질환이 생길 수 있습니다.",
        strengthening: "규칙적인 식사를 유지하세요. 과음과 과식을 피하세요. 위장에 좋은 음식을 섭취하세요.",
        lifestyle: "식사 시간을 지키세요. 회식에서 절제하세요. 점심 후 산책을 습관화하세요. 스트레스를 관리하세요.",
        prevention: "매년 종합검진을 받으세요. 위내시경을 시작하세요."
      },
      "40s": {
        constitution: "토 기운이 균형 잡힌 40대는 소화기 건강 관리에 더 신경 써야 하는 시기입니다. 균형을 유지하면서 노화에 대비하세요.",
        vulnerabilities: "대사 기능이 떨어지기 시작합니다. 체중 증가에 주의해야 합니다. 혈당과 콜레스테롤 관리가 필요합니다.",
        strengthening: "저칼로리, 고섬유질 식단으로 전환하세요. 단 음식을 줄이세요. 소화에 좋은 음식을 섭취하세요.",
        lifestyle: "규칙적인 식사와 운동을 하세요. 체중 관리에 신경 쓰세요. 절제하는 식습관을 유지하세요.",
        prevention: "매년 혈당, 콜레스테롤, 위내시경 검사를 받으세요."
      },
      "50plus": {
        constitution: "토 기운이 균형 잡힌 50대 이후는 그간의 건강한 식습관이 빛을 발합니다. 꾸준한 관리로 건강한 노년을 맞이하세요.",
        vulnerabilities: "소화 기능이 서서히 저하됩니다. 대사 질환 관리가 중요합니다. 위암, 대장암 검진이 필요합니다.",
        strengthening: "소화가 잘 되는 영양가 있는 음식을 먹으세요. 저염, 저당 식단을 유지하세요. 수분을 충분히 섭취하세요.",
        lifestyle: "규칙적인 생활과 식사를 하세요. 적당한 운동을 유지하세요. 체중을 적정 수준으로 관리하세요.",
        prevention: "6개월마다 검진을 받으세요. 암 검진을 빠짐없이 받으세요."
      }
    }
  },
  metal: {
    신강: {
      "20s": {
        constitution: "금 기운이 강한 20대는 폐와 대장 기능이 활발합니다. 피부가 좋고 호흡기가 튼튼하며 면역력이 강합니다.",
        vulnerabilities: "그러나 건조함에 취약하고 피부 트러블이 생길 수 있습니다. 예민한 성격으로 스트레스에 민감합니다. 변비 경향이 있습니다. 알레르기가 있을 수 있습니다.",
        strengthening: "매운맛을 줄이고 촉촉한 음식을 섭취하세요. 흰색 음식(배, 무, 도라지)이 폐를 보합니다. 수분을 충분히 섭취하세요. 건조한 음식을 피하세요.",
        lifestyle: "피부 보습에 신경 쓰세요. 가습기를 사용하세요. 호흡 운동과 등산이 좋습니다. 명상으로 마음을 다스리세요. 금연은 필수입니다.",
        prevention: "알레르기 검사를 받으세요. 피부과 정기 검진을 시작하세요. 호흡기 건강을 챙기세요."
      },
      "30s": {
        constitution: "금 기운이 강한 30대는 환경오염과 스트레스로 호흡기에 부담이 갑니다. 피부 관리에도 신경을 써야 합니다.",
        vulnerabilities: "미세먼지로 인한 호흡기 질환이 생깁니다. 아토피, 알레르기가 악화될 수 있습니다. 변비와 대장 문제가 있습니다. 우울하고 슬픈 감정이 많아집니다.",
        strengthening: "폐에 좋은 음식(배, 더덕, 도라지, 은행)을 섭취하세요. 섬유질이 풍부한 음식으로 장 건강을 챙기세요. 수분을 충분히 섭취하세요. 오메가3를 섭취하세요.",
        lifestyle: "미세먼지 많은 날은 마스크를 쓰세요. 실내 공기를 깨끗하게 유지하세요. 호흡 운동을 규칙적으로 하세요. 금연은 필수입니다. 스트레스를 관리하세요.",
        prevention: "폐 기능 검사를 받으세요. 알레르기 검사와 관리를 하세요. 대장 내시경을 시작하세요."
      },
      "40s": {
        constitution: "금 기운이 강한 40대는 호흡기와 피부 노화가 시작됩니다. 면역 기능 유지와 대장 건강 관리가 중요합니다.",
        vulnerabilities: "기관지염, 천식 등 호흡기 질환이 생깁니다. 피부 노화가 빨라집니다. 대장 질환과 변비가 심해집니다. 우울증 경향이 있습니다.",
        strengthening: "폐와 대장을 보하는 음식을 꾸준히 섭취하세요. 항산화 식품으로 노화를 늦추세요. 프로바이오틱스로 장 건강을 관리하세요. 보습에 신경 쓰세요.",
        lifestyle: "공기 좋은 곳에서 운동하세요. 금연과 미세먼지 차단이 중요합니다. 규칙적인 배변 습관을 유지하세요. 피부 관리에 투자하세요. 스트레스를 줄이세요.",
        prevention: "매년 폐 기능 검사와 흉부 X-ray를 받으세요. 대장 내시경을 정기적으로 받으세요. 피부과 검진을 받으세요."
      },
      "50plus": {
        constitution: "금 기운이 강한 50대 이후는 폐 기능 저하와 대장 질환에 주의해야 합니다. 피부와 호흡기 관리가 삶의 질에 직결됩니다.",
        vulnerabilities: "폐암, 대장암 위험이 있습니다. 만성 호흡기 질환이 생깁니다. 피부가 많이 건조해집니다. 면역력이 떨어집니다.",
        strengthening: "폐와 대장에 좋은 음식을 꾸준히 먹으세요. 단백질과 항산화 식품을 섭취하세요. 수분을 충분히 마시세요. 보양식으로 면역력을 유지하세요.",
        lifestyle: "규칙적인 생활과 적당한 운동을 하세요. 깨끗한 공기를 마시세요. 보습에 신경 쓰세요. 금연과 미세먼지 차단이 필수입니다.",
        prevention: "6개월마다 폐암, 대장암 검진을 받으세요. 호흡기 관리에 힘쓰세요. 면역력 강화에 주력하세요."
      }
    },
    신약: {
      "20s": {
        constitution: "금 기운이 약한 20대는 호흡기와 면역력이 약합니다. 감기에 자주 걸리고 피부가 예민합니다.",
        vulnerabilities: "잦은 감기와 비염, 천식이 있습니다. 피부가 건조하고 트러블이 많습니다. 알레르기 체질일 가능성이 높습니다. 변비와 장 트러블이 있습니다.",
        strengthening: "폐를 보하는 음식(배, 도라지, 더덕, 은행)을 꾸준히 섭취하세요. 매운맛은 적당히, 단맛도 적당히 섭취하세요. 충분한 수분 섭취가 중요합니다. 유산균을 섭취하세요.",
        lifestyle: "환절기에 특히 조심하세요. 마스크를 잘 착용하세요. 실내 습도를 유지하세요. 보습에 신경 쓰세요. 규칙적인 운동으로 면역력을 키우세요.",
        prevention: "폐 기능 검사를 받으세요. 알레르기 검사와 관리를 시작하세요. 면역력 강화에 힘쓰세요."
      },
      "30s": {
        constitution: "금 기운이 약한 30대는 환경오염과 스트레스로 호흡기 질환이 악화됩니다. 면역력 관리가 핵심입니다.",
        vulnerabilities: "만성 비염, 천식이 심해집니다. 잦은 감기와 기관지염에 시달립니다. 피부 트러블과 알레르기가 악화됩니다. 만성 변비와 대장 문제가 있습니다.",
        strengthening: "한약으로 폐 기능을 보강하세요. 면역력을 높이는 음식(버섯, 마늘, 생강)을 섭취하세요. 프로바이오틱스와 비타민 C, D를 섭취하세요. 충분한 수분을 섭취하세요.",
        lifestyle: "미세먼지를 피하고 공기청정기를 사용하세요. 규칙적인 수면으로 면역력을 키우세요. 과로를 피하세요. 스트레스를 관리하세요. 금연은 필수입니다.",
        prevention: "폐 기능 검사와 흉부 X-ray를 받으세요. 알레르기 전문의 진료를 받으세요. 대장 내시경을 시작하세요."
      },
      "40s": {
        constitution: "금 기운이 약한 40대는 호흡기와 면역력이 더욱 약해집니다. 적극적인 보양과 관리가 필요합니다.",
        vulnerabilities: "만성 호흡기 질환이 악화됩니다. 폐렴 등 감염에 취약합니다. 피부 노화가 빨라집니다. 대장 질환 위험이 높아집니다. 우울증 경향이 있습니다.",
        strengthening: "보양 한약으로 폐 기능을 강화하세요. 면역력을 높이는 음식과 보충제를 섭취하세요. 충분한 단백질과 항산화 식품을 먹으세요. 프로바이오틱스를 섭취하세요.",
        lifestyle: "무리하지 말고 충분히 휴식하세요. 공기 좋은 곳에서 지내세요. 규칙적인 생활을 하세요. 스트레스를 줄이세요. 금연과 미세먼지 차단이 필수입니다.",
        prevention: "6개월마다 폐 기능 검사를 받으세요. 폐렴 예방접종을 하세요. 대장 내시경을 정기적으로 받으세요."
      },
      "50plus": {
        constitution: "금 기운이 약한 50대 이후는 호흡기와 면역력 관리가 건강의 핵심입니다. 철저한 보양과 예방이 필요합니다.",
        vulnerabilities: "폐렴, 폐암 위험이 높습니다. 면역력 저하로 각종 감염에 취약합니다. 대장암 위험이 있습니다. 피부가 매우 건조합니다. 우울증이 심화될 수 있습니다.",
        strengthening: "보양 음식과 한약을 꾸준히 복용하세요. 면역력 강화에 총력을 기울이세요. 소화가 잘 되는 고단백 식품을 섭취하세요. 수분을 충분히 마시세요.",
        lifestyle: "감염 예방에 철저히 하세요. 예방접종을 빠짐없이 하세요. 따뜻하고 깨끗한 환경에서 지내세요. 규칙적인 생활과 적당한 운동을 하세요.",
        prevention: "3개월마다 건강 상태를 체크하세요. 폐암, 대장암 검진을 빠짐없이 받으세요. 폐렴 예방접종을 하세요."
      }
    },
    중화: {
      "20s": {
        constitution: "금 기운이 균형 잡힌 20대는 호흡기와 피부가 건강합니다. 면역력이 적당하여 건강한 상태를 유지합니다.",
        vulnerabilities: "균형 잡혀 있지만 흡연이나 환경오염으로 균형이 깨질 수 있습니다. 건조한 환경에 주의하세요.",
        strengthening: "현재의 균형을 유지하세요. 폐에 좋은 음식을 적당히 섭취하세요. 수분을 충분히 마시세요.",
        lifestyle: "금연을 유지하세요. 미세먼지를 피하세요. 보습에 신경 쓰세요. 규칙적인 운동을 하세요.",
        prevention: "매년 기본 건강검진을 받으세요. 폐 건강을 유지하는 것이 중요합니다."
      },
      "30s": {
        constitution: "금 기운이 균형 잡힌 30대는 호흡기와 피부 건강이 양호합니다. 환경 관리를 잘 하면 건강을 유지할 수 있습니다.",
        vulnerabilities: "직장 환경과 스트레스로 호흡기와 피부에 문제가 생길 수 있습니다. 미세먼지에 주의하세요.",
        strengthening: "균형 잡힌 식단을 유지하세요. 폐에 좋은 음식을 꾸준히 섭취하세요. 수분을 충분히 섭취하세요.",
        lifestyle: "좋은 공기 환경을 유지하세요. 보습에 신경 쓰세요. 스트레스를 관리하세요. 금연을 유지하세요.",
        prevention: "매년 폐 기능 검사와 대장 내시경을 받으세요."
      },
      "40s": {
        constitution: "금 기운이 균형 잡힌 40대는 호흡기와 피부 관리에 더 신경 써야 하는 시기입니다. 균형을 유지하면서 노화에 대비하세요.",
        vulnerabilities: "노화로 폐 기능과 피부 탄력이 저하됩니다. 면역력 관리가 중요해집니다. 대장 건강에 주의하세요.",
        strengthening: "폐와 피부에 좋은 음식을 꾸준히 섭취하세요. 항산화 식품을 먹으세요. 수분을 충분히 섭취하세요.",
        lifestyle: "깨끗한 공기 환경을 유지하세요. 피부 관리에 투자하세요. 규칙적인 운동을 하세요. 금연을 유지하세요.",
        prevention: "매년 폐 기능 검사, 대장 내시경, 피부과 검진을 받으세요."
      },
      "50plus": {
        constitution: "금 기운이 균형 잡힌 50대 이후는 그간의 건강한 습관이 빛을 발합니다. 꾸준한 관리로 건강한 노년을 맞이하세요.",
        vulnerabilities: "노화에 따른 폐 기능 저하와 면역력 감소가 진행됩니다. 대장 건강과 피부 관리가 중요합니다.",
        strengthening: "면역력을 높이는 음식을 섭취하세요. 폐와 대장에 좋은 음식을 꾸준히 먹으세요. 수분을 충분히 섭취하세요.",
        lifestyle: "감염 예방에 신경 쓰세요. 깨끗한 환경에서 지내세요. 적당한 운동을 유지하세요. 보습에 신경 쓰세요.",
        prevention: "6개월마다 폐암, 대장암 검진을 받으세요. 폐렴 예방접종을 하세요."
      }
    }
  },
  water: {
    신강: {
      "20s": {
        constitution: "수 기운이 강한 20대는 신장과 방광 기능이 활발합니다. 정력이 좋고 뼈가 튼튼하며 귀가 밝습니다.",
        vulnerabilities: "그러나 과도한 에너지 소모로 신장에 부담이 갈 수 있습니다. 과음과 성생활 과다에 주의하세요. 추위에 약할 수 있습니다. 두려움이 많을 수 있습니다.",
        strengthening: "짠맛을 줄이고 검은색 음식(검은콩, 검은깨, 흑임자)을 섭취하세요. 신장에 좋은 음식(호두, 새우, 굴)을 먹으세요. 수분을 충분히 섭취하세요. 차가운 음식을 피하세요.",
        lifestyle: "과음과 성생활 과다를 피하세요. 하체 운동으로 허리와 무릎을 강화하세요. 따뜻하게 지내세요. 충분한 수면을 취하세요. 용기를 키우세요.",
        prevention: "매년 신장 기능 검사를 받으세요. 허리와 무릎 건강을 챙기세요. 지금부터 관리하면 평생 튼튼합니다."
      },
      "30s": {
        constitution: "수 기운이 강한 30대는 신장 기능이 좋지만 과로와 스트레스가 신장에 부담을 줍니다. 에너지 관리가 중요합니다.",
        vulnerabilities: "과로로 인한 신장 기능 저하가 시작됩니다. 허리 통증과 무릎 문제가 생깁니다. 탈모가 시작될 수 있습니다. 잦은 배뇨와 야뇨가 있을 수 있습니다.",
        strengthening: "신장을 보하는 음식(검은콩, 호두, 잣, 새우)을 섭취하세요. 짜고 차가운 음식을 피하세요. 따뜻한 성질의 음식을 먹으세요. 충분한 수분을 섭취하세요.",
        lifestyle: "과음을 절제하세요. 허리와 무릎 강화 운동을 하세요. 충분한 수면과 휴식을 취하세요. 추위를 피하고 따뜻하게 지내세요. 스트레스를 관리하세요.",
        prevention: "매년 신장 기능 검사를 받으세요. 허리와 무릎 건강을 정기적으로 체크하세요. 탈모가 시작되면 조기에 치료하세요."
      },
      "40s": {
        constitution: "수 기운이 강한 40대는 신장 기능 저하와 관절 문제가 본격화됩니다. 노화를 늦추는 관리가 필요합니다.",
        vulnerabilities: "신장 기능이 떨어지기 시작합니다. 요통, 무릎 관절염이 생깁니다. 탈모가 진행됩니다. 성기능 저하가 나타날 수 있습니다. 골다공증 위험이 있습니다.",
        strengthening: "신장과 뼈를 보하는 음식을 꾸준히 섭취하세요. 칼슘과 비타민 D를 보충하세요. 검은색 음식과 해산물을 먹으세요. 짠 음식을 줄이세요.",
        lifestyle: "허리와 무릎을 보호하세요. 무리한 운동을 피하고 수영이나 걷기를 하세요. 따뜻하게 지내세요. 충분한 휴식을 취하세요. 성생활도 절제하세요.",
        prevention: "매년 신장 기능 검사와 골밀도 검사를 받으세요. 관절 건강을 정기적으로 체크하세요."
      },
      "50plus": {
        constitution: "수 기운이 강한 50대 이후는 신장과 뼈 건강이 삶의 질을 결정합니다. 철저한 관리로 활력 있는 노년을 보내세요.",
        vulnerabilities: "만성 신장 질환 위험이 있습니다. 골다공증과 골절 위험이 높아집니다. 요통, 무릎 관절염이 심해집니다. 전립선/요실금 문제가 생깁니다. 청력 저하가 나타납니다.",
        strengthening: "신장과 뼈에 좋은 음식을 꾸준히 섭취하세요. 단백질과 칼슘을 충분히 섭취하세요. 보양식으로 정기를 보충하세요. 수분을 적당히 섭취하세요.",
        lifestyle: "규칙적인 생활과 적당한 운동을 하세요. 낙상 예방에 주의하세요. 따뜻하게 지내세요. 사회 활동으로 정서 건강을 챙기세요.",
        prevention: "6개월마다 신장 기능과 골밀도 검사를 받으세요. 청력 검사도 정기적으로 받으세요. 필요시 호르몬 치료를 고려하세요."
      }
    },
    신약: {
      "20s": {
        constitution: "수 기운이 약한 20대는 신장과 방광 기능이 약합니다. 기력이 부족하고 쉽게 피로합니다. 추위에 약합니다.",
        vulnerabilities: "잦은 배뇨와 요로 감염이 있습니다. 허리와 무릎이 약합니다. 탈모 경향이 있습니다. 두려움이 많고 자신감이 부족합니다. 성장기 발달이 늦을 수 있습니다.",
        strengthening: "신장을 보하는 음식(검은콩, 검은깨, 호두, 새우)을 꾸준히 섭취하세요. 따뜻한 성질의 음식을 먹으세요. 짜고 차가운 음식을 피하세요. 충분한 단백질을 섭취하세요.",
        lifestyle: "따뜻하게 지내고 추위를 피하세요. 하체 운동으로 허리와 무릎을 강화하세요. 충분한 수면을 취하세요. 자신감을 키우는 활동을 하세요. 무리하지 마세요.",
        prevention: "신장 기능 검사를 받으세요. 요로 감염 시 조기에 치료하세요. 뼈 건강을 챙기세요."
      },
      "30s": {
        constitution: "수 기운이 약한 30대는 과로로 신장 기능이 더욱 약해집니다. 만성 피로와 허리/무릎 문제가 심해집니다.",
        vulnerabilities: "만성 피로와 무기력함이 지속됩니다. 허리 통증과 무릎 약화가 심합니다. 탈모가 진행됩니다. 잦은 배뇨와 야뇨가 있습니다. 성기능 저하가 나타날 수 있습니다.",
        strengthening: "보양 한약으로 신장 기능을 강화하세요. 검은색 음식과 해산물을 꾸준히 섭취하세요. 따뜻한 음식과 차를 마시세요. 비타민 D와 칼슘을 보충하세요.",
        lifestyle: "무리한 업무를 피하고 충분히 휴식하세요. 따뜻하게 지내세요. 가벼운 하체 운동을 하세요. 수면 시간을 확보하세요. 스트레스를 줄이세요.",
        prevention: "6개월마다 신장 기능 검사를 받으세요. 허리/무릎 건강을 체크하세요. 탈모가 심하면 전문 치료를 받으세요."
      },
      "40s": {
        constitution: "수 기운이 약한 40대는 신장 기능 저하와 관절 문제가 심각해집니다. 적극적인 보양과 관리가 필수입니다.",
        vulnerabilities: "만성 신장 질환 위험이 높습니다. 심한 요통과 관절염이 있습니다. 골다공증이 빨리 진행됩니다. 탈모가 심화됩니다. 성기능 저하와 갱년기 증상이 심합니다.",
        strengthening: "보양 한약(녹용, 홍삼, 흑염소)을 복용하세요. 신장과 뼈를 보하는 음식을 꾸준히 섭취하세요. 칼슘과 비타민 D를 충분히 보충하세요. 따뜻한 음식을 먹으세요.",
        lifestyle: "무리하지 말고 충분히 휴식하세요. 따뜻하게 지내고 추위를 피하세요. 허리와 무릎을 보호하세요. 가벼운 운동을 꾸준히 하세요. 정서적 안정을 찾으세요.",
        prevention: "3개월마다 신장 기능과 골밀도 검사를 받으세요. 관절 건강을 정기적으로 체크하세요. 필요시 호르몬 치료를 고려하세요."
      },
      "50plus": {
        constitution: "수 기운이 약한 50대 이후는 신장과 뼈 건강 관리가 최우선입니다. 철저한 보양으로 건강한 노년을 보내세요.",
        vulnerabilities: "만성 신장 질환이 발병할 수 있습니다. 심한 골다공증과 골절 위험이 있습니다. 요실금과 전립선 문제가 있습니다. 청력이 떨어집니다. 전반적인 쇠약이 심합니다.",
        strengthening: "보양 음식과 한약을 꾸준히 복용하세요. 소화가 잘 되는 고단백 음식을 섭취하세요. 칼슘과 비타민 D를 충분히 보충하세요. 따뜻하고 영양가 있는 음식을 먹으세요.",
        lifestyle: "따뜻하게 지내고 추위를 절대 피하세요. 낙상 예방에 최우선 주의하세요. 무리하지 않는 범위에서 운동하세요. 규칙적인 생활을 하세요. 가족과 함께 시간을 보내세요.",
        prevention: "매달 건강 상태를 체크하세요. 신장 기능, 골밀도, 청력 검사를 정기적으로 받으세요. 필요시 투석 준비도 해야 할 수 있습니다."
      }
    },
    중화: {
      "20s": {
        constitution: "수 기운이 균형 잡힌 20대는 신장과 뼈 건강이 양호합니다. 활력이 적당하고 건강한 상태입니다.",
        vulnerabilities: "균형 잡혀 있지만 과음이나 과로로 균형이 깨질 수 있습니다. 추위에 주의하세요.",
        strengthening: "현재의 균형을 유지하세요. 신장에 좋은 음식을 적당히 섭취하세요. 짠 음식을 줄이세요.",
        lifestyle: "규칙적인 생활 습관을 유지하세요. 하체 운동을 꾸준히 하세요. 충분한 수면을 취하세요. 과음을 피하세요.",
        prevention: "매년 기본 건강검진을 받으세요. 신장과 뼈 건강을 유지하는 것이 중요합니다."
      },
      "30s": {
        constitution: "수 기운이 균형 잡힌 30대는 신장과 뼈 건강이 양호한 상태입니다. 적절한 관리로 이 상태를 유지하세요.",
        vulnerabilities: "과로와 스트레스로 신장에 부담이 갈 수 있습니다. 허리와 무릎 관리가 필요합니다.",
        strengthening: "균형 잡힌 식단을 유지하세요. 신장에 좋은 음식을 꾸준히 섭취하세요. 칼슘과 비타민 D를 섭취하세요.",
        lifestyle: "적절한 휴식과 수면을 취하세요. 허리와 무릎 강화 운동을 하세요. 과음을 피하세요. 따뜻하게 지내세요.",
        prevention: "매년 신장 기능 검사를 받으세요. 허리와 무릎 건강을 체크하세요."
      },
      "40s": {
        constitution: "수 기운이 균형 잡힌 40대는 신장과 뼈 건강 관리에 더 신경 써야 하는 시기입니다. 균형을 유지하면서 노화에 대비하세요.",
        vulnerabilities: "노화로 신장 기능과 골밀도가 저하됩니다. 허리와 무릎 관절에 주의해야 합니다.",
        strengthening: "신장과 뼈에 좋은 음식을 꾸준히 섭취하세요. 칼슘과 비타민 D를 보충하세요. 단백질을 충분히 섭취하세요.",
        lifestyle: "규칙적인 운동으로 근력을 유지하세요. 허리와 무릎을 보호하세요. 충분한 휴식을 취하세요. 따뜻하게 지내세요.",
        prevention: "매년 신장 기능 검사와 골밀도 검사를 받으세요."
      },
      "50plus": {
        constitution: "수 기운이 균형 잡힌 50대 이후는 그간의 건강한 습관이 빛을 발합니다. 꾸준한 관리로 건강한 노년을 맞이하세요.",
        vulnerabilities: "노화에 따른 신장 기능 저하와 골밀도 감소가 진행됩니다. 관절 건강과 낙상 예방이 중요합니다.",
        strengthening: "신장과 뼈에 좋은 음식을 꾸준히 섭취하세요. 단백질과 칼슘을 충분히 섭취하세요. 보양식으로 정기를 보충하세요.",
        lifestyle: "규칙적인 생활과 적당한 운동을 하세요. 낙상 예방에 주의하세요. 따뜻하게 지내세요. 사회 활동을 유지하세요.",
        prevention: "6개월마다 신장 기능과 골밀도 검사를 받으세요. 청력 검사도 받으세요."
      }
    }
  }
};

function getStrengthKey(sinGangSinYak: string): StrengthType {
  if (sinGangSinYak === "신강") return "신강";
  if (sinGangSinYak === "신약") return "신약";
  return "중화";
}

// ============================================
// 오행과 장기/건강 매핑
// ============================================

interface ElementHealthInfo {
  organs: string[];
  bodyParts: string[];
  diseases: string[];
  strengthSigns: string[];
  weaknessSigns: string[];
}

const ELEMENT_HEALTH_MAP: Record<FiveElement, ElementHealthInfo> = {
  wood: {
    organs: ["간장", "담낭"],
    bodyParts: ["눈", "근육", "손발톱", "힘줄"],
    diseases: ["간 질환", "담석", "안과 질환", "근육 경련", "두통", "어지러움"],
    strengthSigns: ["눈이 맑음", "근육 발달", "분노 조절 잘함", "결단력 있음"],
    weaknessSigns: ["눈 피로", "근육 약화", "쉽게 화남", "우울감", "손톱 갈라짐"]
  },
  fire: {
    organs: ["심장", "소장"],
    bodyParts: ["혀", "혈관", "얼굴", "땀샘"],
    diseases: ["심장 질환", "고혈압", "불면증", "정신 불안", "구내염", "피부 발진"],
    strengthSigns: ["얼굴 혈색 좋음", "열정적", "소화력 좋음", "정신 맑음"],
    weaknessSigns: ["가슴 두근거림", "불면", "과도한 땀", "불안감", "얼굴 붉어짐"]
  },
  earth: {
    organs: ["비장", "위장"],
    bodyParts: ["입술", "살/근육", "입"],
    diseases: ["소화불량", "위장병", "당뇨", "비만", "식욕부진", "부종"],
    strengthSigns: ["소화력 좋음", "식욕 정상", "체중 안정", "입술 색 좋음"],
    weaknessSigns: ["소화불량", "복부 팽만", "과식/식욕부진", "만성 피로", "걱정 많음"]
  },
  metal: {
    organs: ["폐", "대장"],
    bodyParts: ["피부", "코", "털/모발"],
    diseases: ["호흡기 질환", "피부병", "알레르기", "변비", "천식", "비염"],
    strengthSigns: ["피부 윤기", "호흡 안정", "목소리 맑음", "면역력 좋음"],
    weaknessSigns: ["피부 건조", "잦은 감기", "비염", "변비", "슬픔 많음", "머리카락 빠짐"]
  },
  water: {
    organs: ["신장", "방광"],
    bodyParts: ["귀", "뼈", "골수", "머리카락"],
    diseases: ["신장병", "방광염", "요통", "관절염", "이명", "탈모", "성기능 저하"],
    strengthSigns: ["귀가 밝음", "뼈 튼튼", "정력 좋음", "두려움 없음"],
    weaknessSigns: ["요통", "무릎 약함", "잦은 배뇨", "탈모", "무기력", "두려움 많음"]
  }
};

// 체질 유형
const CONSTITUTION_TYPES: Record<FiveElement, {
  name: string;
  characteristics: string;
  dietAdvice: string;
  exerciseAdvice: string;
}> = {
  wood: {
    name: "목형 체질",
    characteristics: "키가 크고 마른 편, 신경질적일 수 있음, 간담 기능 중시",
    dietAdvice: "신맛 적당히, 녹색 채소 권장, 기름진 음식 자제, 간에 좋은 음식(부추, 미나리, 깻잎) 섭취",
    exerciseAdvice: "스트레칭, 요가, 명상 등 긴장 이완 운동 권장. 과격한 운동보다 유연성 운동이 적합"
  },
  fire: {
    name: "화형 체질",
    characteristics: "상체 발달, 열이 많음, 심장과 혈관 기능 중시",
    dietAdvice: "쓴맛 적당히, 붉은 음식(토마토, 고추) 적절히, 뜨겁고 매운 음식 자제, 심장에 좋은 음식(견과류, 등푸른생선) 섭취",
    exerciseAdvice: "수영, 걷기 등 심박수를 적당히 유지하는 운동. 무리한 운동은 심장에 부담"
  },
  earth: {
    name: "토형 체질",
    characteristics: "복부가 발달, 먹는 것을 좋아함, 비위 기능 중시",
    dietAdvice: "단맛 자제, 황색 음식(호박, 고구마) 적절히, 과식 금물, 비위에 좋은 음식(쌀, 감자, 대추) 섭취",
    exerciseAdvice: "걷기, 등산 등 규칙적인 유산소 운동. 식후 가벼운 산책이 소화에 도움"
  },
  metal: {
    name: "금형 체질",
    characteristics: "피부가 희고 날카로운 인상, 호흡기 기능 중시",
    dietAdvice: "매운맛 적당히, 흰색 음식(배, 무, 도라지) 권장, 건조한 음식 자제, 폐에 좋은 음식(배, 더덕, 도라지) 섭취",
    exerciseAdvice: "등산, 호흡 운동, 단전호흡 권장. 미세먼지 많은 날은 실내 운동"
  },
  water: {
    name: "수형 체질",
    characteristics: "하체가 발달하거나 통통함, 신장과 방광 기능 중시",
    dietAdvice: "짠맛 자제, 검은색 음식(검은콩, 흑임자) 권장, 차가운 음식 자제, 신장에 좋은 음식(검은깨, 호두, 새우) 섭취",
    exerciseAdvice: "수영, 아쿠아로빅 등 물 관련 운동. 허리 강화 운동과 하체 운동 권장"
  }
};

// ============================================
// 일간 오행 추출
// ============================================

function getDayMasterElement(sajuResult: SajuApiResult): FiveElement {
  const stemElementMap: Record<HeavenlyStemKr, FiveElement> = {
    갑: "wood", 을: "wood",
    병: "fire", 정: "fire",
    무: "earth", 기: "earth",
    경: "metal", 신: "metal",
    임: "water", 계: "water"
  };

  const dayStem = sajuResult.dayPillar.cheongan as HeavenlyStemKr;
  return stemElementMap[dayStem] || "earth";
}

// ============================================
// 오행 분포 분석
// ============================================

function analyzeElementDistribution(sajuResult: SajuApiResult): Record<FiveElement, number> {
  const count: Record<FiveElement, number> = {
    wood: 0, fire: 0, earth: 0, metal: 0, water: 0
  };

  const stemElementMap: Record<string, FiveElement> = {
    갑: "wood", 을: "wood",
    병: "fire", 정: "fire",
    무: "earth", 기: "earth",
    경: "metal", 신: "metal",
    임: "water", 계: "water"
  };

  const branchElementMap: Record<string, FiveElement> = {
    인: "wood", 묘: "wood",
    사: "fire", 오: "fire",
    진: "earth", 술: "earth", 축: "earth", 미: "earth",
    신: "metal", 유: "metal",
    해: "water", 자: "water"
  };

  const pillars = [
    sajuResult.yearPillar,
    sajuResult.monthPillar,
    sajuResult.dayPillar,
    sajuResult.timePillar
  ];

  pillars.forEach(pillar => {
    if (!pillar) return;

    const stem = pillar.cheongan as string;
    const branch = pillar.jiji as string;

    if (stemElementMap[stem]) {
      count[stemElementMap[stem]]++;
    }
    if (branchElementMap[branch]) {
      count[branchElementMap[branch]]++;
    }
  });

  return count;
}

// ============================================
// 건강 상태 분석
// ============================================

interface ElementHealthAnalysis {
  element: FiveElement;
  organs: string[];
  status: "건강" | "주의" | "취약";
  diseases: string[];
}

function analyzeElementHealth(
  elementDistribution: Record<FiveElement, number>,
  dayMasterElement: FiveElement
): ElementHealthAnalysis[] {
  const result: ElementHealthAnalysis[] = [];
  const elements: FiveElement[] = ["wood", "fire", "earth", "metal", "water"];

  elements.forEach(element => {
    const count = elementDistribution[element];
    const healthInfo = ELEMENT_HEALTH_MAP[element];

    let status: "건강" | "주의" | "취약";
    let diseases: string[];

    // 오행이 없거나 1개만 있으면 취약
    // 4개 이상이면 과다로 주의
    // 2-3개면 건강
    if (count === 0) {
      status = "취약";
      diseases = healthInfo.diseases.slice(0, 3);
    } else if (count === 1) {
      status = "주의";
      diseases = healthInfo.diseases.slice(0, 2);
    } else if (count >= 4) {
      status = "주의"; // 과다도 주의
      diseases = [`${healthInfo.organs[0]} 기능 과다로 인한 문제`, healthInfo.diseases[0]];
    } else {
      status = "건강";
      diseases = [];
    }

    // 일간 오행이 약하면 추가 주의
    if (element === dayMasterElement && count < 2) {
      status = "주의";
      diseases = healthInfo.diseases.slice(0, 2);
    }

    result.push({
      element,
      organs: healthInfo.organs,
      status,
      diseases
    });
  });

  return result;
}

// ============================================
// 체질 유형 분석
// ============================================

interface ConstitutionType {
  name: string;
  characteristics: string;
  dietAdvice: string;
  exerciseAdvice: string;
}

function analyzeConstitutionType(
  dayMasterElement: FiveElement,
  elementDistribution: Record<FiveElement, number>
): ConstitutionType {
  // 일간 오행 기반 체질, 다른 강한 오행이 있으면 복합 체질
  const baseConstitution = CONSTITUTION_TYPES[dayMasterElement];

  // 가장 많은 오행 찾기
  let dominantElement = dayMasterElement;
  let maxCount = elementDistribution[dayMasterElement];

  (Object.entries(elementDistribution) as [FiveElement, number][]).forEach(([elem, count]) => {
    if (count > maxCount) {
      maxCount = count;
      dominantElement = elem;
    }
  });

  // 일간과 다른 오행이 지배적이면 복합 체질
  if (dominantElement !== dayMasterElement && maxCount > elementDistribution[dayMasterElement]) {
    const secondaryConstitution = CONSTITUTION_TYPES[dominantElement];
    return {
      name: `${baseConstitution.name} + ${secondaryConstitution.name} (복합)`,
      characteristics: `${baseConstitution.characteristics} 또한 ${secondaryConstitution.characteristics.split(",")[0]}의 특성도 있습니다.`,
      dietAdvice: `${baseConstitution.dietAdvice} 추가로, ${secondaryConstitution.dietAdvice.split(",")[0]}도 참고하세요.`,
      exerciseAdvice: `${baseConstitution.exerciseAdvice} ${secondaryConstitution.exerciseAdvice.split(".")[0]}도 도움이 됩니다.`
    };
  }

  return baseConstitution;
}

// ============================================
// 건강 경고 분석
// ============================================

interface HealthWarning {
  condition: string;
  preventionAdvice: string;
}

function analyzeHealthWarnings(
  elementHealthMap: ElementHealthAnalysis[],
  dayMasterElement: FiveElement,
  sinGangSinYak: string
): HealthWarning[] {
  const warnings: HealthWarning[] = [];

  // 취약한 오행에 대한 경고
  elementHealthMap.forEach(item => {
    if (item.status === "취약") {
      warnings.push({
        condition: `${item.organs.join(", ")} 관련 질환 주의`,
        preventionAdvice: `${ELEMENT_HEALTH_MAP[item.element].weaknessSigns.slice(0, 2).join(", ")} 증상이 나타나면 조기 검진을 받으세요.`
      });
    }
  });

  // 신강/신약에 따른 경고
  if (sinGangSinYak === "신강") {
    warnings.push({
      condition: "과로 및 스트레스 주의",
      preventionAdvice: "에너지가 넘치지만 과신하지 마세요. 적절한 휴식과 스트레스 관리가 필요합니다."
    });
  } else if (sinGangSinYak === "신약") {
    warnings.push({
      condition: "면역력 저하 주의",
      preventionAdvice: "기력이 약할 수 있으니 충분한 휴식과 영양 섭취가 중요합니다. 무리하지 마세요."
    });
  }

  // 일간 오행별 특별 주의사항
  const specialWarnings: Record<FiveElement, HealthWarning> = {
    wood: {
      condition: "눈과 간 건강 관리",
      preventionAdvice: "장시간 모니터 사용을 피하고, 음주를 절제하며 간 건강을 챙기세요."
    },
    fire: {
      condition: "심장과 혈압 관리",
      preventionAdvice: "정기적인 혈압 체크와 심장 건강 검진을 권장합니다. 흥분이나 격앙을 피하세요."
    },
    earth: {
      condition: "소화기 건강 관리",
      preventionAdvice: "규칙적인 식사와 과식 금물. 위장 건강을 위해 자극적인 음식을 피하세요."
    },
    metal: {
      condition: "호흡기와 피부 관리",
      preventionAdvice: "미세먼지가 많은 날 외출 자제, 피부 보습 관리. 금연과 환기에 신경 쓰세요."
    },
    water: {
      condition: "신장과 관절 관리",
      preventionAdvice: "충분한 수분 섭취와 허리/무릎 건강 관리. 추위에 노출을 피하세요."
    }
  };

  warnings.push(specialWarnings[dayMasterElement]);

  return warnings;
}

// ============================================
// 연령대별 건강 조언
// ============================================

interface AgeSpecificAdvice {
  ageGroup: AgeGroup;
  focusAreas: string[];
  lifestyle: string;
  checkupRecommendations: string[];
}

function generateAgeSpecificAdvice(
  ageGroup: AgeGroup,
  dayMasterElement: FiveElement,
  elementHealthMap: ElementHealthAnalysis[]
): AgeSpecificAdvice {
  const vulnerableOrgans = elementHealthMap
    .filter(e => e.status === "취약" || e.status === "주의")
    .flatMap(e => e.organs);

  const baseAdvice: Record<AgeGroup, {
    focusAreas: string[];
    lifestyle: string;
    checkups: string[];
  }> = {
    "20s": {
      focusAreas: ["체력 기반 구축", "생활 습관 형성", "스트레스 관리"],
      lifestyle: "규칙적인 생활 패턴을 만들고, 운동 습관을 기르세요. 야식과 음주를 절제하고 충분한 수면을 취하세요. 이 시기에 형성된 습관이 평생 건강의 기초가 됩니다.",
      checkups: ["기본 건강검진", "치아 검진", "안과 검진"]
    },
    "30s": {
      focusAreas: ["대사 기능 관리", "체중 관리", "직장인 건강"],
      lifestyle: "바쁜 직장 생활 속에서도 운동 시간을 확보하세요. 앉아있는 시간을 줄이고, 점심시간 가벼운 산책을 권장합니다. 회식 자리에서 과음을 피하고 영양 균형 잡힌 식사를 하세요.",
      checkups: ["종합 건강검진", "위/대장 내시경", "갑상선 검사", "혈압/혈당 체크"]
    },
    "40s": {
      focusAreas: ["만성질환 예방", "호르몬 변화 관리", "노화 관리"],
      lifestyle: "정기적인 건강검진이 필수입니다. 고혈압, 당뇨, 고지혈증 등 성인병 관리에 신경 쓰세요. 무리한 운동보다 꾸준한 중강도 운동이 효과적입니다. 수면의 질을 높이는 것이 중요합니다.",
      checkups: ["종합 건강검진", "심혈관 검사", "암 검진", "골밀도 검사", "안과 정밀 검진"]
    },
    "50plus": {
      focusAreas: ["만성질환 관리", "골다공증 예방", "인지 기능 유지"],
      lifestyle: "규칙적이고 적절한 운동으로 근력을 유지하세요. 낙상 예방에 주의하고, 사회적 활동으로 정신 건강도 챙기세요. 정기적인 건강검진과 약물 복용 관리가 중요합니다.",
      checkups: ["종합 건강검진", "암 정밀 검진", "심혈관 정밀 검사", "골밀도 검사", "치매 선별 검사", "청력 검사"]
    }
  };

  const base = baseAdvice[ageGroup];

  // 취약 장기에 대한 검진 추가
  const additionalCheckups: string[] = [];
  vulnerableOrgans.forEach(organ => {
    if (organ.includes("간")) additionalCheckups.push("간 기능 검사");
    if (organ.includes("심장")) additionalCheckups.push("심전도/심초음파");
    if (organ.includes("폐")) additionalCheckups.push("폐 기능 검사");
    if (organ.includes("신장")) additionalCheckups.push("신장 기능 검사");
    if (organ.includes("위")) additionalCheckups.push("위내시경");
  });

  return {
    ageGroup,
    focusAreas: base.focusAreas,
    lifestyle: base.lifestyle,
    checkupRecommendations: [...new Set([...base.checkups, ...additionalCheckups])]
  };
}

// ============================================
// 오행 한글명
// ============================================

const ELEMENT_NAMES_KR: Record<FiveElement, string> = {
  wood: "목(木)",
  fire: "화(火)",
  earth: "토(土)",
  metal: "금(金)",
  water: "수(水)"
};

// ============================================
// Narrative 생성 함수
// ============================================

/**
 * 건강운 서술형 Narrative 생성
 */
function generateHealthNarrative(
  elementHealthMap: ElementHealthAnalysis[],
  constitutionType: ConstitutionType,
  healthWarnings: HealthWarning[],
  ageSpecificAdvice: AgeSpecificAdvice,
  dayMasterElement: FiveElement,
  sinGangSinYak: string
): Chapter11Result["narrative"] {
  const strengthKey = getStrengthKey(sinGangSinYak);
  const strengthNarrative = HEALTH_STRENGTH_NARRATIVES[dayMasterElement]?.[strengthKey]?.[ageSpecificAdvice.ageGroup];

  // 도입부
  let intro = "이제 건강운에 대해 살펴보겠습니다. 사주에서 건강을 보는 것은 오행의 균형을 통해 어떤 장기가 강하고 어떤 장기가 약한지를 파악하는 것입니다.\n\n";
  intro += "오행은 각각 우리 몸의 장기와 연결되어 있습니다. 목(木)은 간과 담, 화(火)는 심장과 소장, 토(土)는 비장과 위장, 금(金)은 폐와 대장, 수(水)는 신장과 방광에 해당합니다. ";
  intro += "사주에서 특정 오행이 부족하거나 과다하면 해당 장기에 문제가 생길 가능성이 높아집니다.";

  // 본론: 체질 분석
  let mainAnalysis = "【체질 분석】\n\n";
  mainAnalysis += `귀하의 체질은 '${constitutionType.name}'입니다.\n\n`;
  mainAnalysis += `${constitutionType.characteristics}\n\n`;

  // 일간 오행에 따른 기본 건강 특성
  const dayMasterHealthInfo = ELEMENT_HEALTH_MAP[dayMasterElement];
  mainAnalysis += `일간이 ${ELEMENT_NAMES_KR[dayMasterElement]}이시므로, ${dayMasterHealthInfo.organs.join(", ")} 기능이 귀하의 건강에서 핵심이 됩니다. `;
  mainAnalysis += `이 장기들이 건강하면 전체적인 건강 상태가 좋고, 이 장기들이 약해지면 연쇄적으로 다른 곳에도 영향을 미치게 됩니다.\n\n`;

  // 신강신약별 상세 건강 분석 추가
  if (strengthNarrative) {
    mainAnalysis += "【신강신약별 건강 특성】\n\n";
    mainAnalysis += `• 체질 특성\n${strengthNarrative.constitution}\n\n`;
    mainAnalysis += `• 취약점\n${strengthNarrative.vulnerabilities}\n\n`;
    mainAnalysis += `• 강화 방법\n${strengthNarrative.strengthening}\n\n`;
  }

  // 오행별 건강 상태
  mainAnalysis += "【오행별 건강 상태】\n\n";

  const vulnerableElements = elementHealthMap.filter(e => e.status === "취약");
  const cautionElements = elementHealthMap.filter(e => e.status === "주의");
  const healthyElements = elementHealthMap.filter(e => e.status === "건강");

  if (healthyElements.length > 0) {
    mainAnalysis += "• 건강한 부분\n";
    for (const elem of healthyElements) {
      mainAnalysis += `  - ${ELEMENT_NAMES_KR[elem.element]}: ${elem.organs.join(", ")} 기능이 안정적입니다.\n`;
    }
    mainAnalysis += "\n";
  }

  if (cautionElements.length > 0) {
    mainAnalysis += "• 주의가 필요한 부분\n";
    for (const elem of cautionElements) {
      mainAnalysis += `  - ${ELEMENT_NAMES_KR[elem.element]}: ${elem.organs.join(", ")} 기능에 주의가 필요합니다.\n`;
      if (elem.diseases.length > 0) {
        mainAnalysis += `    주의 질환: ${elem.diseases.join(", ")}\n`;
      }
    }
    mainAnalysis += "\n";
  }

  if (vulnerableElements.length > 0) {
    mainAnalysis += "• 취약한 부분\n";
    for (const elem of vulnerableElements) {
      mainAnalysis += `  - ${ELEMENT_NAMES_KR[elem.element]}: ${elem.organs.join(", ")} 기능이 선천적으로 약합니다.\n`;
      if (elem.diseases.length > 0) {
        mainAnalysis += `    주의 질환: ${elem.diseases.join(", ")}\n`;
      }
    }
    mainAnalysis += "\n";
  }

  // 상세 분석
  const details: string[] = [];

  // 신강신약별 생활 관리 및 예방 조언
  if (strengthNarrative) {
    let strengthLifestyleDetail = "【신강신약별 생활 관리 가이드】\n\n";
    strengthLifestyleDetail += `• 생활 습관 조언\n${strengthNarrative.lifestyle}\n\n`;
    strengthLifestyleDetail += `• 예방 및 검진 가이드\n${strengthNarrative.prevention}`;
    details.push(strengthLifestyleDetail);
  }

  // 식이 및 운동 조언
  let lifestyleDetail = "【체질에 맞는 생활 관리】\n\n";
  lifestyleDetail += "• 식이 조언\n";
  lifestyleDetail += `${constitutionType.dietAdvice}\n\n`;
  lifestyleDetail += "• 운동 조언\n";
  lifestyleDetail += `${constitutionType.exerciseAdvice}\n\n`;
  lifestyleDetail += "체질에 맞는 음식과 운동을 꾸준히 실천하면 건강을 오래 유지할 수 있습니다.";
  details.push(lifestyleDetail);

  // 건강 경고
  if (healthWarnings.length > 0) {
    let warningDetail = "【건강 주의 사항】\n\n";
    for (const warning of healthWarnings) {
      warningDetail += `• ${warning.condition}\n`;
      warningDetail += `  → ${warning.preventionAdvice}\n\n`;
    }
    details.push(warningDetail);
  }

  // 연령대별 조언
  let ageDetail = `【${ageSpecificAdvice.ageGroup === "20s" ? "20대" :
                     ageSpecificAdvice.ageGroup === "30s" ? "30대" :
                     ageSpecificAdvice.ageGroup === "40s" ? "40대" : "50대 이상"} 건강 관리 가이드】\n\n`;

  ageDetail += "• 이 시기 집중 관리 영역\n";
  for (const area of ageSpecificAdvice.focusAreas) {
    ageDetail += `  - ${area}\n`;
  }
  ageDetail += "\n";

  ageDetail += "• 생활 습관 조언\n";
  ageDetail += `${ageSpecificAdvice.lifestyle}\n\n`;

  ageDetail += "• 권장 건강 검진\n";
  for (const checkup of ageSpecificAdvice.checkupRecommendations) {
    ageDetail += `  - ${checkup}\n`;
  }
  details.push(ageDetail);

  // 조언
  let advice = "【건강 관리의 핵심】\n\n";
  advice += "사주에서 보이는 건강 운은 선천적인 체질과 경향을 보여주는 것입니다. 이것은 '운명'이 아니라 '경향'입니다. ";
  advice += "미리 알고 관리하면 충분히 예방할 수 있습니다.\n\n";

  advice += "건강 관리의 핵심은 다음과 같습니다:\n\n";
  advice += "1. 취약한 장기는 미리 검진받고 관리하세요.\n";
  advice += "2. 체질에 맞는 음식을 섭취하고, 맞지 않는 음식은 피하세요.\n";
  advice += "3. 규칙적인 운동으로 기혈 순환을 원활히 하세요.\n";
  advice += "4. 스트레스 관리에 신경 쓰고, 충분한 휴식을 취하세요.\n";
  advice += "5. 정기적인 건강검진을 받으세요.\n\n";

  if (vulnerableElements.length > 0) {
    const vulnerableOrgans = vulnerableElements.flatMap(e => e.organs);
    advice += `특히 ${vulnerableOrgans.join(", ")} 관련 검진은 주기적으로 받기 바랍니다.`;
  }

  // 마무리
  const closing = "이상으로 건강운 분석을 마치겠습니다. 사주에서 보이는 건강 정보는 참고 자료일 뿐, 실제 건강 상태는 정기적인 검진을 통해 확인하기 바랍니다. 미리 알고 대비하면 건강한 삶을 오래 유지할 수 있습니다. 무엇보다 규칙적인 생활과 긍정적인 마음가짐이 건강의 근본임을 기억하세요.";

  return {
    intro,
    mainAnalysis,
    details,
    advice,
    closing,
  };
}

// ============================================
// 메인 분석 함수
// ============================================

export function analyzeChapter11(
  sajuResult: SajuApiResult,
  _gender: Gender,
  ageGroup: AgeGroup,
  sinGangSinYak: string
): Chapter11Result {
  // 기본 분석
  const dayMasterElement = getDayMasterElement(sajuResult);
  const elementDistribution = analyzeElementDistribution(sajuResult);

  // 오행별 건강 상태
  const elementHealthMap = analyzeElementHealth(elementDistribution, dayMasterElement);

  // 체질 유형
  const constitutionType = analyzeConstitutionType(dayMasterElement, elementDistribution);

  // 건강 경고
  const healthWarnings = analyzeHealthWarnings(elementHealthMap, dayMasterElement, sinGangSinYak);

  // 연령대별 조언
  const ageSpecificAdvice = generateAgeSpecificAdvice(ageGroup, dayMasterElement, elementHealthMap);

  // 서술형 Narrative 생성
  const narrative = generateHealthNarrative(
    elementHealthMap,
    constitutionType,
    healthWarnings,
    ageSpecificAdvice,
    dayMasterElement,
    sinGangSinYak
  );

  return {
    elementHealthMap,
    constitutionType,
    healthWarnings,
    ageSpecificAdvice,
    narrative,
  };
}
